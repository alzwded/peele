<html>
<head>
    <title>
        Peele
    </title>
</head>
<body>
    <h1>Peele</h1>
    <h2>Dependencies</h2>
    <ul>
        <li>perl</li>
        <li>Wx</li>
        <li>wxPerl</li>
        <li>Wx::Html</li>
        <li>Wx::HtmlWindow</li>
        <li>Wx::SimplePlotter</li>
        <li>DBI</li>
        <li>DBD::SQLite</li>
    </ul>
    <h2>Plugin interfaces</h2>
    <h3>Expression Plugins</h3>
    <table border="1">
        <thead>
            <td><b>function</b></td>
            <td><b>form</b></td>
            <td><b>description</b></td>
        </thead>
        <tr>
            <td>new</td>
            <td>new(cfg) &rarr; function</td>
            <td>factory that returns a configured applyable <em>function</em></td>
        </tr>
        <tr>
            <td>apply</td>
            <td>function::apply(x) &rarr; y</td>
            <td>apply the function to <em>x</em> and yield the result; result can be a scalar, an array or a lambda</td>
        </tr>
        <tr>
            <td>default_parameters</td>
            <td>default_parameters &rarr; hash</td>
            <td>returns a plugin specific configuration <em>hash</em>; the format of a hash is <pre>{ $aScalarValue =&rarr; 42, @anArray =&rarr; [1, 2, 3] }</pre></td>
        </tr>
    </table>
    <h3>DB Drivers</h3>
    <table border="1">
        <thead>
            <td><b>function</b></td>
            <td><b>form</b></td>
            <td><b>description</b></td>
        </thead>
        <tr>
            <td>open</td>
            <td>open(cfg) &rarr;</td>
            <td>open a connection to the database and apply the given configuration to the driver</td>
        </tr>
        <tr>
            <td>close</td>
            <td>close &rarr;</td>
            <td>close the connection</td>
        </tr>
        <tr>
            <td>get</td>
            <td>get(name) &rarr; result</td>
            <td>return the variable with <em>name</em>; The return type is a hash of the form { type, value }, where type is any of { field, array, wave, lambda } and value can be a string, array, wave or lambda hash</td>
        </tr>
        <tr>
            <td>set</td>
            <td>set(name, value) &rarr; result</td>
            <td>set the variable with <em>name</em> to <em>value</em> if given; if <em>value</em> is not given, the variable is deleted; <em>value</em> is of the same form as that returned by <em>get</em></td>
        </tr>
        <tr>
            <td>default_parameters</td>
            <td>default_parameters &rarr; hash</td>
            <td>returns a plugin specific configuration <em>hash</em>; the format of a hash is <pre>{ $aScalarValue =&rarr; 42, @anArray =&rarr; [1, 2, 3] }</pre></td>
        </tr>
    </table>
    <h2>Data format</h2>
    <p>The data format returned by DB plugins is as follows:</p>
    <pre>
field:
{
    type =&gt; 'field',
    value =&gt; 42,
}

array:
{
    type =&gt; 'array',
    value =&gt; [1, 2, 3],
}

wave:
{
    type =&gt; 'wave',
    value =&gt; {
        plot1 =&gt; [1, 2, 3],
        plotN =&gt; [2, 4, 8],
    },
}

lambda:
{
    type =&gt; 'lambda',
    value =&gt; {
        plugin =&gt; 'pluginName',
        config =&gt; {
            '$scalarField' =&gt; 42,
            '@arrayField' =&gt; [1, 2, 3],
        },
        value =&gt; {
            type =&gt; 'field', # or array, or wave
            value =&gt; 42, # or [1, 2, 3] or { plot1 =&gt; [1, 2, 3], }
        },
    }
}

in BNF:
data ::= field | array | wave | lambda ;
field ::= "{" "type" "=&gt;" "'field'" "," "value" "=&gt;" SCALAR ;
array ::= "{" "type" "=&gt;" "'array'" "," "value" "=&gt;" ARRAY_REF ;
wave ::= "{" "type" "=&gt;" "'array'" "," "value" "=&gt;" "{" wave_def "}" ;
wave_def ::= plot "," | wave_def plot "," ;
plot ::= STRING&lt;plotname&gt; "=&gt;" ARRAY_REF ;
lambda ::= "{" "type" "=&gt;" "'array'" ","
           "value" "=&gt;" "{" lambda_def "}" ;
lambda_def ::= "plugin" "=&gt;" STRING&lt;pluginname&gt; ","
               "config" "=&gt;" config_def ","
               "return" "=&gt;" lambda_return ;
lambda_return ::= field | array | wave ;
config_def ::= "{" config_list "}" ;
config_list ::= config_item | config_list config_item ;
config_item ::= "$"ID&lt;fieldname&gt; "=&gt;" SCALAR
            |   "@"ID&lt;fieldname&gt; "=&gt;" ARRAY_REF
            ;

ID ::= "[^ \t\n\r\0]*" ;

SCALAR ::= /* perl scalar */ ;
ARRAY_REF ::= /* perl array ref */ ;
STRING ::= /* perl string */ ;
    </pre>
</body>
